<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BTC Paper Trading - USD & INR</title>
<style>
  body {
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    background:#0f1724; color:#e6eef8; margin:0; padding:28px;
  }
  .card {
    background:linear-gradient(180deg,#0b1220 0%, #071026 100%);
    border:1px solid rgba(255,255,255,0.04);
    padding:20px; border-radius:12px;
    max-width:960px; margin:16px auto;
    box-shadow:0 10px 30px rgba(2,6,23,0.6);
  }
  h2 { margin-top:0; }
  label { display:block; font-size:13px; color:#9fb0d1; margin-top:12px; }
  input, select {
    width:100%; padding:10px 12px; margin-top:6px;
    border-radius:8px; border:1px solid rgba(255,255,255,0.06);
    background:#071428; color:#dcecff; box-sizing:border-box;
  }
  .btn {
    margin-top:16px; padding:10px 16px; border-radius:8px;
    background:#0ea5a1; color:#012; border:none;
    cursor:pointer; font-weight:600;
  }
  .btn:hover { background:#14b8a6; }
  .results {
    margin-top:18px; background:rgba(255,255,255,0.03);
    padding:12px; border-radius:8px;
  }
  .rline {
    display:flex; justify-content:space-between;
    padding:8px 6px; border-bottom:1px dashed rgba(255,255,255,0.05);
  }
  .muted { color:#89a3c2; font-size:13px; }
  table {
    width:100%; border-collapse:collapse; margin-top:18px;
    font-size:14px; background:rgba(255,255,255,0.02);
  }
  th, td { padding:10px; border-bottom:1px solid rgba(255,255,255,0.05); }
  th { color:#a6c1e3; text-align:left; }
  tr:hover { background:rgba(255,255,255,0.03); }
</style>
</head>
<body>
  <div class="card">
    <h2>BTC Paper Trading Calculator (USD / INR)</h2>
    <p class="muted">Simulate leveraged Bitcoin trades in USD or INR and track your results.</p>

    <label>Currency</label>
    <select id="currency">
      <option value="USD">USD ($)</option>
      <option value="INR">INR (â‚¹)</option>
    </select>

    <label>USD â†’ INR conversion rate</label>
    <input id="usdToInr" type="number" step="0.01" value="83" />

    <label>Side</label>
    <select id="side"><option value="long">Long</option><option value="short">Short</option></select>

    <label>Entry Price (USD)</label>
    <input id="entry" type="number" step="0.01" value="70000" />

    <label>Exit Price (USD)</label>
    <input id="exit" type="number" step="0.01" value="71000" />

    <label>Leverage (x)</label>
    <input id="leverage" type="number" step="1" min="1" value="10" />

    <label>Position Size (BTC)</label>
    <input id="size" type="number" step="0.0001" value="0.01" />

    <label>Fee (%)</label>
    <input id="feePct" type="number" step="0.0001" value="0.02" />

    <label>Maintenance Margin (%)</label>
    <input id="maintPct" type="number" step="0.0001" value="0.5" />

    <button class="btn" id="calc">ðŸ’° Calculate Trade</button>

    <div class="results" id="results" style="display:none;">
      <div class="rline"><div>Notional</div><div id="notional"></div></div>
      <div class="rline"><div>Initial Margin</div><div id="initialMargin"></div></div>
      <div class="rline"><div>Unrealized P/L</div><div id="pnl"></div></div>
      <div class="rline"><div>Fees</div><div id="fees"></div></div>
      <div class="rline"><div>Net P/L</div><div id="netPnl"></div></div>
      <div class="rline"><div>ROI</div><div id="roi"></div></div>
      <div class="rline"><div>Estimated Liquidation Price</div><div id="liq"></div></div>
    </div>
  </div>

  <div class="card">
    <h3>ðŸ“Š Trade History</h3>
    <table id="historyTable">
      <thead>
        <tr>
          <th>Date</th>
          <th>Side</th>
          <th>Entry</th>
          <th>Exit</th>
          <th>Leverage</th>
          <th>BTC Size</th>
          <th>P/L</th>
          <th>ROI</th>
          <th>Currency</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

<script>
function fmt(x){ return (Number.isFinite(x) ? x.toLocaleString(undefined,{maximumFractionDigits:2}) : 'â€”'); }

// Load history
function loadHistory() {
  const data = JSON.parse(localStorage.getItem('tradeHistory') || '[]');
  const tbody = document.querySelector('#historyTable tbody');
  tbody.innerHTML = '';
  data.forEach(t => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${t.date}</td>
      <td>${t.side}</td>
      <td>${t.entry}</td>
      <td>${t.exit}</td>
      <td>${t.leverage}x</td>
      <td>${t.size}</td>
      <td>${t.symbol}${fmt(t.pnl)}</td>
      <td>${fmt(t.roi)}%</td>
      <td>${t.currency}</td>
    `;
    tbody.appendChild(tr);
  });
}

// Save trade
function saveTrade(trade) {
  const data = JSON.parse(localStorage.getItem('tradeHistory') || '[]');
  data.unshift(trade); // newest on top
  localStorage.setItem('tradeHistory', JSON.stringify(data.slice(0, 50))); // keep last 50
  loadHistory();
}

document.getElementById('calc').addEventListener('click', ()=>{
  const currency = document.getElementById('currency').value;
  const usdToInr = parseFloat(document.getElementById('usdToInr').value) || 83;
  const side = document.getElementById('side').value;
  const entry = parseFloat(document.getElementById('entry').value);
  const exit = parseFloat(document.getElementById('exit').value);
  const lev = parseFloat(document.getElementById('leverage').value);
  const qtyBTC = parseFloat(document.getElementById('size').value);
  const feePct = parseFloat(document.getElementById('feePct').value)/100;
  const maintPct = parseFloat(document.getElementById('maintPct').value)/100;

  const notional = qtyBTC * entry;
  const initialMargin = notional / lev;
  let pnl = (side === 'long') ? qtyBTC * (exit - entry) : qtyBTC * (entry - exit);
  const fees = (notional + qtyBTC * exit) * feePct;
  const netPnl = pnl - fees;
  const roi = (netPnl / initialMargin) * 100;
  const cushion = Math.max(0, initialMargin - (notional * maintPct));
  const liqPrice = (side === 'long')
    ? entry - (cushion / qtyBTC)
    : entry + (cushion / qtyBTC);

  const conv = currency === 'INR' ? usdToInr : 1;
  const sym = currency === 'INR' ? 'â‚¹' : '$';

  // Display results
  document.getElementById('results').style.display = 'block';
  document.getElementById('notional').textContent = sym + ' ' + fmt(notional * conv);
  document.getElementById('initialMargin').textContent = sym + ' ' + fmt(initialMargin * conv);
  document.getElementById('pnl').textContent = sym + ' ' + fmt(pnl * conv);
  document.getElementById('fees').textContent = sym + ' ' + fmt(fees * conv);
  document.getElementById('netPnl').textContent = sym + ' ' + fmt(netPnl * conv);
  document.getElementById('roi').textContent = fmt(roi) + '%';
  document.getElementById('liq').textContent = '$ ' + fmt(liqPrice);

  // Save trade to history
  const trade = {
    date: new Date().toLocaleString(),
    side, entry, exit, leverage: lev, size: qtyBTC,
    pnl: netPnl * conv, roi, currency, symbol: sym
  };
  saveTrade(trade);
});

// Initialize
loadHistory();
</script>
</body>
</html>

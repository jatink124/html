<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learner Web Builder Suite</title>
    
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&family=Roboto:wght@300;400;700&family=Ubuntu:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* GLOBAL & DASHBOARD STYLES */
        body { margin: 0; background: #f0f2f5; font-family: 'Roboto', sans-serif; }
        
        .dashboard-card { transition: transform 0.2s, box-shadow 0.2s; }
        .dashboard-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .category-pill { cursor: pointer; transition: all 0.2s; }
        .category-pill.active { background-color: #3b82f6; color: white; border-color: #3b82f6; }
        .category-pill:hover:not(.active) { background-color: #e2e8f0; }

        /* BUILDER SPECIFIC STYLES */
        .builder-mode { height: 100vh; overflow: hidden; }
        #canvas-frame {
            height: 100%; width: 100%; overflow-y: scroll;
            background: white; box-shadow: -5px 0 15px rgba(0,0,0,0.05);
            padding-bottom: 100px; scroll-behavior: smooth;
        }
        .color-box input[type="color"] { opacity: 0; position: absolute; left: 0; top: 0; width: 100%; height: 100%; cursor: pointer; }
        .color-box { position: relative; width: 100%; height: 40px; border: 1px solid #ddd; border-radius: 4px; overflow: hidden; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .nav-icon.active { background-color: #0099ff; color: white; }
        .nav-icon { color: #555; transition: all 0.2s; }
        .nav-icon:hover:not(.active) { background-color: #e9ecef; color: #0099ff; }
        .settings-input { width: 100%; border: 1px solid #e2e8f0; border-radius: 6px; padding: 8px 12px; font-size: 13px; background-color: #fff; }
        .draggable-item { cursor: grab; transition: all 0.2s ease; position: relative; background: white; border: 1px solid #e2e8f0; border-radius: 0.375rem; }
        .draggable-item:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); border-color: #93c5fd; z-index: 10; }
        .draggable-item.dragging { opacity: 0.9; background: #eff6ff; border: 1px dashed #3b82f6; cursor: grabbing; z-index: 50; }
        .canvas-section-wrapper { transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); border: 2px solid transparent; }
        .canvas-section-wrapper.is-highlighted { transform: scale(0.98); border-color: #3b82f6; box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1); border-radius: 8px; overflow: hidden; }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // ==========================================
        // 1. DATA: THE TEMPLATE LIST
        // ==========================================
        const RAW_FILE_LIST = [
            'Automotive\\CarDealership.html',
            'ecommerce\\DigitalDownloads.html',
            'ecommerce\\electronics.html',
            'ecommerce\\Fashionstores.html',
            'ecommerce\\GroceryStore.html',
            'ecommerce\\Handmadeproducts.html',
            'ecommerce\\languagelearning.html',
            'ecommerce\\universitiesschools.html',
            'Education\\CoachingInstitute.html',
            'Education\\educationlearning.html',
            'Entertainment\\Music.html',
            'Finance\\banking.html',
            'Finance\\stocktrading.html',
            'Health\\Fitnessgym.html',
            'Health\\MedicalClinics.html',
            'Health\\Mentalhealth.html',
            'Health\\NutritionDiet.html',
            'Health\\telemedicineplatforms.html',
            'Hospitality\\barsnightclubs.html',
            'Hospitality\\cateringservices.html',
            'Hospitality\\FoodDeliveryServices.html',
            'Hospitality\\Hotelsresorts.html',
            'Hospitality\\Restaurantcafes.html',
            'Legal\\Digitalnotaryservices.html',
            'Legal\\LawFirms.html',
            'Legal\\Legalconsultation.html',
            'personalportfolio\\projectbased1.html',
            'personalportfolio\\projectbased2.html',
            'personalportfolio\\projectsbased.html',
            'personalportfolio\\webdeveloper.html',
            'personalportfolio\\webdeveloper2.html',
            'Realestate\\agentportfolio.html',
            'Realestate\\Commerciallistings.html',
            'Realestate\\luxuryrealestate.html',
            'Realestate\\rentalservices.html',
            'Realestate\\residentialproperties.html',
            'sports\\gymfitnesscentres.html',
            'sports\\personaltraining.html',
            'sports\\yoga.html',
            'technology\\Hosting.html',
            'technology\\ITconsultancy.html',
            'technology\\saas.html',
            'Travel\\adventuretourism.html',
            'Travel\\TravelAgencies.html'
        ];

        // Helper to organize raw paths into nested objects
        const processTemplates = () => {
            const categories = {};
            RAW_FILE_LIST.forEach(path => {
                // Split by backslash (escaped)
                const parts = path.split('\\');
                const category = parts[0];
                const filename = parts[1];
                
                if (!categories[category]) {
                    categories[category] = [];
                }
                
                // Human readable name (remove .html, add spaces before capitals)
                const cleanName = filename.replace('.html', '').replace(/([A-Z])/g, ' $1').trim();
                categories[category].push({
                    id: path,
                    filename: filename,
                    name: cleanName,
                    path: path
                });
            });
            return categories;
        };

        const TEMPLATE_DATA = processTemplates();
        const ALL_CATEGORIES = ['All', ...Object.keys(TEMPLATE_DATA)];

        // ==========================================
        // 2. DASHBOARD COMPONENT
        // ==========================================
        
        const Dashboard = ({ onSelectTemplate }) => {
            const [activeCategory, setActiveCategory] = useState('All');
            const [searchTerm, setSearchTerm] = useState('');

            const filteredTemplates = useMemo(() => {
                let templates = [];
                if (activeCategory === 'All') {
                    Object.values(TEMPLATE_DATA).forEach(list => templates.push(...list));
                } else {
                    templates = TEMPLATE_DATA[activeCategory] || [];
                }

                if (searchTerm) {
                    templates = templates.filter(t => t.name.toLowerCase().includes(searchTerm.toLowerCase()));
                }
                return templates;
            }, [activeCategory, searchTerm]);

            return (
                <div className="min-h-screen pb-10">
                    {/* Top Bar */}
                    <div className="bg-white border-b px-8 py-4 sticky top-0 z-50 flex justify-between items-center shadow-sm">
                        <div className="flex items-center gap-3">
                            <div className="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-xl">L</div>
                            <h1 className="text-xl font-bold text-gray-800">Learner Templates</h1>
                        </div>
                        <div className="relative w-96">
                            <i className="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                            <input 
                                type="text" 
                                placeholder="Search templates..." 
                                className="w-full pl-10 pr-4 py-2 border rounded-full bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                value={searchTerm}
                                onChange={(e) => setSearchTerm(e.target.value)}
                            />
                        </div>
                        <button className="bg-gray-900 text-white px-5 py-2 rounded-full font-medium text-sm">My Account</button>
                    </div>

                    <div className="container mx-auto mt-8 px-4">
                        {/* Category Filter */}
                        <div className="flex flex-wrap gap-2 mb-8 justify-center">
                            {ALL_CATEGORIES.map(cat => (
                                <button 
                                    key={cat}
                                    onClick={() => setActiveCategory(cat)}
                                    className={`px-4 py-2 rounded-full border text-sm font-medium category-pill capitalize ${activeCategory === cat ? 'active' : 'bg-white text-gray-600 border-gray-200'}`}
                                >
                                    {cat}
                                </button>
                            ))}
                        </div>

                        {/* Grid */}
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            {filteredTemplates.map((template) => (
                                <div key={template.id} className="bg-white rounded-xl border border-gray-100 overflow-hidden dashboard-card flex flex-col h-full">
                                    {/* Mock Preview Image */}
                                    <div className="h-40 bg-gray-100 relative group overflow-hidden">
                                        <div className="absolute inset-0 flex items-center justify-center text-4xl text-gray-300">
                                            <i className={`fas fa-${getIconForCategory(template.path)}`}></i>
                                        </div>
                                        {/* Overlay */}
                                        <div className="absolute inset-0 bg-blue-900/0 group-hover:bg-blue-900/10 transition-all duration-300"></div>
                                    </div>
                                    
                                    <div className="p-5 flex-1 flex flex-col">
                                        <div className="text-xs font-bold text-blue-500 uppercase tracking-wide mb-1">
                                            {template.path.split('\\')[0]}
                                        </div>
                                        <h3 className="font-bold text-gray-800 mb-2 truncate" title={template.name}>{template.name}</h3>
                                        <div className="mt-auto pt-4">
                                            <button 
                                                onClick={() => onSelectTemplate(template)}
                                                className="w-full py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition shadow-lg shadow-blue-500/30 flex items-center justify-center gap-2"
                                            >
                                                <i className="fas fa-edit"></i> Edit Online
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        // Helper to give icon based on folder name
        const getIconForCategory = (path) => {
            if(path.includes('Automotive')) return 'car';
            if(path.includes('ecommerce')) return 'shopping-cart';
            if(path.includes('Education')) return 'graduation-cap';
            if(path.includes('Entertainment')) return 'music';
            if(path.includes('Finance')) return 'chart-line';
            if(path.includes('Health')) return 'heart-pulse';
            if(path.includes('Hospitality')) return 'utensils';
            if(path.includes('Legal')) return 'gavel';
            if(path.includes('Realestate')) return 'home';
            if(path.includes('sports')) return 'dumbbell';
            if(path.includes('technology')) return 'laptop-code';
            if(path.includes('Travel')) return 'plane';
            return 'file-code';
        }

        // ==========================================
        // 3. BUILDER COMPONENT (Based on your provided code)
        // ==========================================
        
        const Builder = ({ selectedTemplate, onBack }) => {
            const { useState, useEffect, useRef } = React;

            const DEFAULT_CONFIG = {
                colors: {
                    background: '#ffffff',
                    default: '#333333',
                    heading: '#0f172a',
                    accent: '#0d6efd',
                    surface: '#f8f9fa',
                    contrast: '#e2e8f0',
                    nav: '#ffffff',
                    navHover: '#e9ecef'
                },
                fonts: {
                    default: 'Roboto',
                    heading: 'Raleway',
                    nav: 'Ubuntu'
                },
                header: {
                    position: 'sticky', 
                    showScrollSpy: false
                }
            };

            const INITIAL_SECTIONS = [
                { id: 'header', label: 'Header', type: 'Header', visible: true },
                { id: 'hero', label: 'Hero Section', type: 'Hero', visible: true },
                { id: 'features', label: 'Features Grid', type: 'Features', visible: true },
                { id: 'stats', label: 'Stats Counter', type: 'Stats', visible: true },
                { id: 'instructors', label: 'Content Block', type: 'Instructors', visible: true },
                { id: 'footer', label: 'Footer', type: 'Footer', visible: true },
            ];

            // Hydrate settings from selected Template
            const DEFAULT_PAGE_SETTINGS = {
                name: selectedTemplate ? selectedTemplate.name : 'Home Page',
                slug: selectedTemplate ? selectedTemplate.filename.replace('.html','') : 'index',
                status: 'published',
                seoTitle: selectedTemplate ? `${selectedTemplate.name} - Learner` : 'Online Page',
                seoDesc: 'Generated via Learner Builder',
                keywords: 'web, builder'
            };

            const [activeTab, setActiveTab] = useState('page'); 
            const [config, setConfig] = useState(DEFAULT_CONFIG);
            const [sections, setSections] = useState(INITIAL_SECTIONS);
            const [pageSettings, setPageSettings] = useState(DEFAULT_PAGE_SETTINGS);
            const [pageAccordion, setPageAccordion] = useState('sections'); 
            const [hoveredSection, setHoveredSection] = useState(null);
            const dragItem = useRef(null);

            // Handlers
            const updateColor = (key, value) => setConfig(prev => ({ ...prev, colors: { ...prev.colors, [key]: value } }));
            const updateFont = (key, value) => setConfig(prev => ({ ...prev, fonts: { ...prev.fonts, [key]: value } }));
            const updatePageSetting = (key, value) => setPageSettings(prev => ({ ...prev, [key]: value }));
            const toggleSection = (id) => setSections(sections.map(s => s.id === id ? { ...s, visible: !s.visible } : s));
            const togglePageAccordion = (section) => setPageAccordion(pageAccordion === section ? '' : section);

            const handleSectionHover = (id) => {
                setHoveredSection(id);
                const element = document.getElementById(`canvas-${id}`);
                if (element) element.scrollIntoView({ behavior: 'smooth', block: 'center' });
            };

            const handleDragStart = (e, position) => {
                dragItem.current = position;
                e.target.classList.add('dragging');
            };

            const handleDragEnter = (e, position) => {
                e.preventDefault(); 
                if (dragItem.current === null || dragItem.current === position) return;
                const newSections = [...sections];
                const draggedItemContent = newSections[dragItem.current];
                newSections.splice(dragItem.current, 1);
                newSections.splice(position, 0, draggedItemContent);
                dragItem.current = position;
                setSections(newSections);
            };

            const handleDragEnd = (e) => {
                e.target.classList.remove('dragging');
                dragItem.current = null;
            };

            const moveSection = (index, direction) => {
                const newSections = [...sections];
                if (direction === 'up' && index > 0) {
                    [newSections[index], newSections[index - 1]] = [newSections[index - 1], newSections[index]];
                } else if (direction === 'down' && index < newSections.length - 1) {
                    [newSections[index], newSections[index + 1]] = [newSections[index + 1], newSections[index]];
                }
                setSections(newSections);
            };

            // RENDERERS (StyleInjector, Header, Hero etc. copied from original)
            const StyleInjector = ({ config }) => (
                <style>
                    {`
                        :root {
                            --bs-primary: ${config.colors.accent};
                            --bs-body-bg: ${config.colors.background};
                            --bs-body-color: ${config.colors.default};
                            --heading-color: ${config.colors.heading};
                            --surface-color: ${config.colors.surface};
                        }
                        body { font-family: '${config.fonts.default}', sans-serif; }
                        h1, h2, h3, h4, h5, h6 { font-family: '${config.fonts.heading}', sans-serif; color: var(--heading-color) !important; }
                        .nav-link { font-family: '${config.fonts.nav}', sans-serif; }
                        .bg-surface { background-color: var(--surface-color); }
                        .text-accent { color: var(--bs-primary); }
                        .btn-primary { background-color: var(--bs-primary); border-color: var(--bs-primary); }
                    `}
                </style>
            );

            // Re-using simplified components for the view
            const HeaderComp = ({ config }) => (
                <nav className={`navbar navbar-expand-lg bg-white shadow-sm ${config.header.position === 'sticky' ? 'sticky-top' : ''} ${config.header.position === 'fixed' ? 'fixed-top' : ''}`}>
                    <div className="container">
                        <a className="navbar-brand fw-bold fs-3 text-primary" href="#">Learner</a>
                        <div className="collapse navbar-collapse">
                            <ul className="navbar-nav ms-auto mb-2 mb-lg-0">
                                <li className="nav-item"><a className="nav-link active" href="#">Home</a></li>
                                <li className="nav-item"><a className="nav-link" href="#">Link 1</a></li>
                                <li className="nav-item"><a className="nav-link" href="#">Link 2</a></li>
                            </ul>
                            <button className="btn btn-primary ms-3 rounded-pill px-4">Action</button>
                        </div>
                    </div>
                </nav>
            );

            const HeroComp = ({ config, pageName }) => (
                <section className="py-5 d-flex align-items-center" style={{ minHeight: '80vh' }}>
                    <div className="container">
                        <div className="row align-items-center">
                            <div className="col-lg-6">
                                <span className="badge bg-light text-primary mb-3">Welcome to</span>
                                <h1 className="display-3 fw-bold mb-4">{pageName}</h1>
                                <p className="lead mb-4">This is your editable template. Use the builder on the left to modify styles and sections.</p>
                                <button className="btn btn-primary btn-lg rounded-pill">Call to Action</button>
                            </div>
                            <div className="col-lg-6"><div className="bg-gray-200 rounded-4 w-100" style={{height:'400px'}}></div></div>
                        </div>
                    </div>
                </section>
            );
            
            // ... (Keeping the structure concise for the example, assume other sub-components Features, Footer exist as in original)

            const ColorInput = ({ label, colorKey }) => (
                <div className="col-4 mb-3">
                    <div className="color-box mb-1 shadow-sm" style={{backgroundColor: config.colors[colorKey]}}>
                        <input type="color" value={config.colors[colorKey]} onChange={(e) => updateColor(colorKey, e.target.value)} />
                    </div>
                    <label className="text-[10px] uppercase font-bold text-gray-500 block text-center tracking-wider">{label}</label>
                </div>
            );

            return (
                <div className="flex h-screen bg-white builder-mode">
                    {/* 1. LEFT ICON NAV */}
                    <div className="w-16 border-r bg-white flex flex-col items-center py-4 gap-4 shadow-sm z-20">
                        <div className="text-2xl text-blue-600 mb-4 cursor-pointer" onClick={onBack} title="Back to Dashboard"><i className="fas fa-arrow-left"></i></div>
                        <NavIcon icon="fa-palette" active={activeTab === 'colors'} onClick={() => setActiveTab('colors')} tooltip="Colors" />
                        <NavIcon icon="fa-font" active={activeTab === 'fonts'} onClick={() => setActiveTab('fonts')} tooltip="Typography" />
                        <NavIcon icon="fa-file-lines" active={activeTab === 'page'} onClick={() => setActiveTab('page')} tooltip="Page Options" />
                        <NavIcon icon="fa-window-maximize" active={activeTab === 'header'} onClick={() => setActiveTab('header')} tooltip="Header" />
                        <NavIcon icon="fa-window-minimize" active={activeTab === 'footer'} onClick={() => setActiveTab('footer')} tooltip="Footer" />
                    </div>

                    {/* 2. SETTINGS PANEL */}
                    <div className="w-80 bg-gray-50 border-r flex flex-col shadow-inner z-10">
                        <div className="h-14 border-b bg-white flex items-center px-4 font-bold text-gray-700 uppercase tracking-wide text-sm">
                            {activeTab === 'page' ? pageSettings.name : `${activeTab} Options`}
                        </div>

                        <div className="flex-1 overflow-y-auto custom-scroll">
                            {/* TAB: COLORS */}
                            {activeTab === 'colors' && (
                                <div className="p-4">
                                    <div className="row g-2">
                                        <ColorInput label="Backgrnd" colorKey="background" />
                                        <ColorInput label="Heading" colorKey="heading" />
                                        <ColorInput label="Accent" colorKey="accent" />
                                    </div>
                                </div>
                            )}

                             {/* TAB: FONTS */}
                             {activeTab === 'fonts' && (
                                <div className="p-4 space-y-4">
                                    <FontSelector label="Default Font" value={config.fonts.default} onChange={(v) => updateFont('default', v)} />
                                    <FontSelector label="Heading Font" value={config.fonts.heading} onChange={(v) => updateFont('heading', v)} />
                                </div>
                            )}

                            {/* TAB: PAGE & SECTIONS */}
                            {activeTab === 'page' && (
                                <div>
                                    <div className="border-b bg-white">
                                        <button onClick={() => togglePageAccordion('general')} className="w-full px-4 py-3 flex justify-between items-center text-xs font-bold uppercase text-gray-600 hover:bg-gray-50 transition">
                                            <span>Info</span> <i className={`fas fa-chevron-${pageAccordion === 'general' ? 'up' : 'down'}`}></i>
                                        </button>
                                        {pageAccordion === 'general' && (
                                            <div className="p-4 bg-gray-50 border-t space-y-3">
                                                <div><label className="settings-label">Page Name</label><input type="text" className="settings-input" value={pageSettings.name} onChange={(e) => updatePageSetting('name', e.target.value)} /></div>
                                                <div><label className="settings-label">Slug</label><input type="text" className="settings-input" value={pageSettings.slug} onChange={(e) => updatePageSetting('slug', e.target.value)} /></div>
                                            </div>
                                        )}
                                    </div>
                                    <div className="border-b bg-white">
                                        <button onClick={() => togglePageAccordion('sections')} className="w-full px-4 py-3 flex justify-between items-center text-xs font-bold uppercase text-gray-600 hover:bg-gray-50 transition">
                                            <span>Structure</span> <i className={`fas fa-chevron-${pageAccordion === 'sections' ? 'up' : 'down'}`}></i>
                                        </button>
                                        {pageAccordion === 'sections' && (
                                            <div className="p-2 bg-gray-50 border-t space-y-2">
                                                {sections.map((section, idx) => (
                                                    <div key={section.id} 
                                                        draggable="true"
                                                        onDragStart={(e) => handleDragStart(e, idx)}
                                                        onDragEnter={(e) => handleDragEnter(e, idx)}
                                                        onDragEnd={handleDragEnd}
                                                        onDragOver={(e) => e.preventDefault()}
                                                        onMouseEnter={() => handleSectionHover(section.id)}
                                                        onMouseLeave={() => setHoveredSection(null)}
                                                        className="draggable-item p-2 flex items-center gap-2"
                                                    >
                                                        <div className="text-gray-300 px-1 cursor-grab"><i className="fas fa-grip-vertical text-xs"></i></div>
                                                        <span className="flex-1 text-xs font-bold text-gray-600 truncate">{section.label}</span>
                                                        <button onClick={() => toggleSection(section.id)} className={`text-sm w-6 ${section.visible ? 'text-blue-500' : 'text-gray-300'}`}><i className={`fas ${section.visible ? 'fa-eye' : 'fa-eye-slash'}`}></i></button>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                </div>
                            )}

                             {/* TAB: HEADER */}
                             {activeTab === 'header' && (
                                <div className="p-4">
                                     <div className="flex gap-3 text-sm text-gray-600">
                                        <label className="flex items-center gap-1 cursor-pointer">
                                            <input type="radio" name="hpos" checked={config.header.position === 'static'} onChange={() => setConfig({...config, header: {...config.header, position: 'static'}})} /> Static
                                        </label>
                                        <label className="flex items-center gap-1 cursor-pointer">
                                            <input type="radio" name="hpos" checked={config.header.position === 'sticky'} onChange={() => setConfig({...config, header: {...config.header, position: 'sticky'}})} /> Sticky
                                        </label>
                                    </div>
                                </div>
                             )}
                        </div>
                    </div>

                    {/* 3. CANVAS (Preview Area) */}
                    <div className="flex-1 relative bg-gray-200">
                        {/* Top Bar for Canvas */}
                        <div className="h-14 bg-white border-b flex items-center justify-between px-6 shadow-sm absolute w-full top-0 left-0 z-10">
                            <div className="flex items-center gap-2">
                                <span className="font-bold text-gray-700">{pageSettings.name}</span>
                                <span className="px-2 py-0.5 bg-gray-100 text-gray-500 text-xs rounded border">{pageSettings.slug}.html</span>
                            </div>
                            <div className="flex gap-2">
                                <button className="bg-green-500 hover:bg-green-600 text-white px-4 py-1.5 rounded text-sm font-bold transition shadow-sm">
                                    <i className="fas fa-save me-2"></i> Save
                                </button>
                                <button onClick={onBack} className="bg-gray-500 hover:bg-gray-600 text-white px-4 py-1.5 rounded text-sm font-bold transition shadow-sm">
                                    Exit
                                </button>
                            </div>
                        </div>

                        {/* The Actual Page */}
                        <div id="canvas-frame" className="pt-14">
                            <StyleInjector config={config} />
                            {sections.map(section => {
                                if (!section.visible) return null;
                                const isHovered = hoveredSection === section.id;
                                return (
                                    <div key={section.id} id={`canvas-${section.id}`} className={`canvas-section-wrapper ${isHovered ? 'is-highlighted' : ''}`}>
                                        {(() => {
                                            switch(section.type) {
                                                case 'Header': return <HeaderComp config={config} />;
                                                case 'Hero': return <HeroComp config={config} pageName={pageSettings.name} />;
                                                case 'Features': return <section className="py-5 bg-surface"><div className="container"><h2>Features of {pageSettings.slug}</h2></div></section>;
                                                case 'Stats': return <div className="py-5 text-center bg-light"><h3>Stats Placeholder</h3></div>;
                                                case 'Instructors': return <div className="py-5 text-center bg-white"><h3>Content Placeholder</h3></div>;
                                                case 'Footer': return <footer className="bg-dark text-white py-5 text-center">Footer for {pageSettings.name}</footer>;
                                                default: return null;
                                            }
                                        })()}
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                </div>
            );
        };

        const NavIcon = ({ icon, active, onClick, tooltip }) => (
            <button onClick={onClick} title={tooltip} className={`w-10 h-10 rounded-lg flex items-center justify-center text-lg nav-icon ${active ? 'active' : ''}`}>
                <i className={`fas ${icon}`}></i>
            </button>
        );

        const FontSelector = ({ label, value, onChange }) => (
            <div className="bg-white p-3 border rounded shadow-sm">
                <label className="text-xs font-bold text-gray-500 mb-2 block">{label}</label>
                <div className="relative">
                    <select value={value} onChange={(e) => onChange(e.target.value)} className="w-full border border-gray-300 rounded p-2 text-sm appearance-none bg-transparent relative z-10">
                        <option value="Roboto">Roboto</option>
                        <option value="Raleway">Raleway</option>
                        <option value="Ubuntu">Ubuntu</option>
                    </select>
                </div>
            </div>
        );

        // ==========================================
        // 4. MAIN APP ROUTER
        // ==========================================

        const MainApp = () => {
            const [currentView, setCurrentView] = useState('dashboard'); // 'dashboard' | 'builder'
            const [selectedTemplate, setSelectedTemplate] = useState(null);

            const handleSelectTemplate = (template) => {
                setSelectedTemplate(template);
                setCurrentView('builder');
            };

            const handleBackToDashboard = () => {
                setSelectedTemplate(null);
                setCurrentView('dashboard');
            };

            return (
                <React.Fragment>
                    {currentView === 'dashboard' && (
                        <Dashboard onSelectTemplate={handleSelectTemplate} />
                    )}
                    {currentView === 'builder' && (
                        <Builder selectedTemplate={selectedTemplate} onBack={handleBackToDashboard} />
                    )}
                </React.Fragment>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MainApp />);
    </script>
</body>
</html>